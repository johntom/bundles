define("aurelia-portal-attribute/portal",["require","exports","module","aurelia-templating","aurelia-pal"],function(t,e,i){"use strict";var r=this&&this.__decorate||function(t,e,i,r){var o,n=arguments.length,a=n<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,r);else for(var l=t.length-1;0<=l;l--)(o=t[l])&&(a=(n<3?o(a):3<n?o(e,i,a):o(e,i))||a);return 3<n&&a&&Object.defineProperty(e,i,a),a};Object.defineProperty(e,"__esModule",{value:!0});var a=t("aurelia-templating"),o=t("aurelia-pal").PLATFORM.global.document,n=function(){function t(t,e){this.viewFactory=t,this.originalViewslot=e,this.strict=!1,this.initialRender=!1,this.currentTarget=l}return(e=t).getTarget=function(t,e){if(t){if("string"==typeof t){var i=o;e&&("string"==typeof e&&(e=o.querySelector(e)),e instanceof Element&&(i=e)),t=i.querySelector(t)}if(t instanceof Element)return t}return null},t.prototype.bind=function(t,e){this.callbackContext||(this.callbackContext=t);var i=this.view;i||(i=this.view=this.viewFactory.create());var r=this.initialRender;r&&this.originalViewslot.add(i),i.bind(t,e),r&&this.originalViewslot.remove(i)},t.prototype.attached=function(){return this.isAttached=!0,this.render()},t.prototype.detached=function(){this.isAttached=!1,this.viewSlot&&this.viewSlot.detached()},t.prototype.unbind=function(){this.viewSlot&&(this.viewSlot.remove(this.view),this.viewSlot=null),this.view.unbind(),this.callbackContext=null},t.prototype.getTarget=function(){var t=e.getTarget(this.target,this.renderContext);if(null===t){if(this.strict)throw new Error("Render target not found.");t=o.body}return t},t.prototype.render=function(){var e=this,i=this.currentTarget,r=this.view,o=this.currentTarget=this.getTarget(),t=this.viewSlot;if(i!==o||!t){var n=function(){return e.isAttached?Promise.resolve("function"==typeof e.activating?e.activating.call(e.callbackContext,o,r):null).then(function(){if(o===e.currentTarget||i===l){var t=e.viewSlot=new a.ViewSlot(o,!0);t.attached(),t.add(r),e.removed=!1}return Promise.resolve().then(function(){"function"==typeof e.activated&&e.activated.call(e.callbackContext,o,r)})}):Promise.resolve(null)};return t?Promise.resolve("function"==typeof this.deactivating?this.deactivating.call(this.callbackContext,i,r):null).then(function(){return"function"==typeof e.deactivated&&e.deactivated.call(e.callbackContext,i,r),e.viewSlot=null,e.removed||(t.remove(r),e.removed=!0),n()}):Promise.resolve(n())}},t.prototype.targetChanged=function(){return this.render()},t.inject=[a.BoundViewFactory,a.ViewSlot],r([a.bindable({primaryProperty:!0,defaultValue:null})],t.prototype,"target",void 0),r([a.bindable({changeHandler:"targetChanged"})],t.prototype,"renderContext",void 0),r([a.bindable()],t.prototype,"strict",void 0),r([a.bindable()],t.prototype,"initialRender",void 0),r([a.bindable()],t.prototype,"deactivating",void 0),r([a.bindable()],t.prototype,"activating",void 0),r([a.bindable()],t.prototype,"activated",void 0),r([a.bindable()],t.prototype,"deactivated",void 0),r([a.bindable()],t.prototype,"callbackContext",void 0),t=e=r([a.templateController(),a.customAttribute("portal")],t);var e}();e.Portal=n;var l={}});